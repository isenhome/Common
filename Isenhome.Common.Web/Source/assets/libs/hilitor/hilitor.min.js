function Hilitor(id,tag,isIframe){var targetNode;if(!isIframe){var targetNode=document.getElementById(id)||document.body}else{if(id){targetNode=document.getElementById(id).contentDocument}}var hiliteTag=tag||"EM";var skipTags=new RegExp("^(?:"+hiliteTag+"|SCRIPT|FORM|SPAN)$");var colors=["#ff6"];var wordColor=[];var colorIdx=0;var matchRegex="";var openLeft=false;var openRight=false;var maxIteration=5e3;this.setMatchType=function(type){switch(type){case"left":this.openLeft=false;this.openRight=true;break;case"right":this.openLeft=true;this.openRight=false;break;case"open":this.openLeft=this.openRight=true;break;default:this.openLeft=this.openRight=false}};this.setRegex=function(input){input=input.replace(/^[^\w]+|[^\w]+$/g,"").replace(/ /g,"|");var re="("+input+")";if(!this.openLeft)re="\\b"+re;if(!this.openRight)re=re+"\\b";matchRegex=new RegExp(re,"i")};this.getRegex=function(){var retval=matchRegex.toString();retval=retval.replace(/(^\/(\\b)?|\(|\)|(\\b)?\/i$)/g,"");retval=retval.replace(/\|/g," ");return retval};this.hiliteWords=function(node){if(this.currentIteration>=maxIteration)return;if(node==undefined||!node)return;if(!matchRegex)return;if(skipTags.test(node.nodeName))return;if(node.hasChildNodes()){for(var i=0;i<node.childNodes.length;i++){this.hiliteWords(node.childNodes[i])}}if(node.nodeType==3){this.currentIteration++;if((nv=node.nodeValue)&&(regs=matchRegex.exec(nv))){if(!wordColor[regs[0].toLowerCase()]){wordColor[regs[0].toLowerCase()]=colors[colorIdx++%colors.length]}var match=document.createElement(hiliteTag);match.className="hilitor";match.style.cursor="pointer";match.appendChild(document.createTextNode(regs[0]));match.style.backgroundColor=wordColor[regs[0].toLowerCase()];match.style.fontStyle="inherit";match.style.color="#000";var after=node.splitText(regs.index);after.nodeValue=after.nodeValue.substring(regs[0].length);node.parentNode.insertBefore(match,after)}}};this.remove=function(){var arr=document.getElementsByTagName(hiliteTag);this.currentIteration=0;while(arr.length&&(el=arr[0])){var parent=el.parentNode;parent.replaceChild(el.firstChild,el);parent.normalize()}};this.apply=function(input){if(input==undefined||!input)return;this.remove();this.setRegex(input);this.hiliteWords(targetNode)}}